# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json

providers:
  - id: openrouter:openai/gpt-oss-20b
    config:
      apiBaseUrl: https://openrouter.ai/api/v1
      apiKeyEnv: API_KEY
      max_tokens: 512
      temperature: 0.2

  - id: openrouter:mistralai/mistral-small-3.2-24b-instruct
    config:
      apiBaseUrl: https://openrouter.ai/api/v1
      apiKeyEnv: API_KEY
      max_tokens: 512
      temperature: 0.2

  - id: openrouter:qwen/qwen-2.5-7b-instruct
    config:
      apiBaseUrl: https://openrouter.ai/api/v1
      apiKeyEnv: API_KEY
      max_tokens: 512
      temperature: 0.2

defaultTest:
  options:
    transformVars: file://./title_transform.js:transformVars
    transform: file://./title_transform.js:transformOutput
  vars:
    system_message: file://../prompt/title_generation.j2
    locale: "en"

prompts:
  - >
    {{ title_messages | dump }}

tests:
  - description: "Normal chat"
    vars:
      user_prompt: "What is the capital of France?"
      agent_answer: |
        Paris is the capital of France. It one of the most visited cities in the world, and known for Eiffel Tower, Notre-Dame Cathedral, and the Louvre Museum.

        Tell me if you want to know more about Paris.
    assert:
      - type: contains
        value: "Paris"
  - description: "Generate image"
    vars:
      user_prompt: "Generate a photorealistic image of a bustling street market in New Orleans during Mardi Gras"
      agent_answer: I’m sorry, but I can’t help with that.
    assert:
      - type: contains-any
        value:
          - "Mardi"
          - "Gras"
  - description: "What's the meaning of life?"
    vars:
      user_prompt: "What's the meaning of life?"
      agent_answer: |
        The meaning of life is subjective and varies from person to person. Some people believe that life is about finding happiness, while others believe that it's about achieving success or making a difference in the world.
    assert:
      - type: contains-any
        value:
          - "Meaning"
          - "Life"
  - description: "Simplified Chinese title generation"
    vars:
      user_prompt: "什么是机器学习?"
      agent_answer: |
        机器学习是人工智能的一个分支，它使计算机能够在没有明确编程的情况下学习和改进。
      locale: "zh-cn"
    assert:
      - type: contains-any
        value:
          - "机器"
          - "学习"
  - description: "Traditional Chinese title generation"
    vars:
      user_prompt: "台灣夜市有什麼必吃美食？"
      agent_answer: |
        台灣夜市有許多經典小吃，例如鹽酥雞、珍珠奶茶、蚵仔煎與滷味。各地夜市特色不同，可以依照口味挑選。
      locale: "zh-tw"
    assert:
      - type: contains-any
        value:
          - "台灣"
          - "夜市"
          - "美食"
  - description: "Rust lifetime troubleshooting"
    vars:
      user_prompt: "Why does Rust complain about lifetimes in this function?"
      agent_answer: |
        Rust needs explicit lifetimes when it can't infer how long references live. Add named lifetimes to the function signature and avoid returning references to local data.
    assert:
      - type: contains-any
        value:
          - "Rust"
          - "lifetime"
          - "borrow"
  - description: "Project planning summary"
    vars:
      user_prompt: "Help me draft a 3-step rollout plan for a new feature."
      agent_answer: |
        Start with internal testing, then limited beta rollout, and finally a full public launch with monitoring and support.
    assert:
      - type: contains-any
        value:
          - "Plan"
          - "Rollout"
          - "Launch"

#
outputPath: ./promptfoo/promptfoo-results-title.json

sharing: false
