# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json

providers:
  - id: openrouter:openai/gpt-oss-20b
    config:
      apiBaseUrl: https://openrouter.ai/api/v1
      apiKeyEnv: API_KEY
      max_tokens: 4096

  - id: openrouter:qwen/qwen3-30b-a3b
    config:
      apiBaseUrl: https://openrouter.ai/api/v1
      apiKeyEnv: API_KEY
      max_tokens: 4096

defaultTest:
  options:
    provider: openrouter:openai/gpt-oss-120b
  vars:
    system_message: file://../prompt/search.j2
    locale: "en"
    time: "2025-12-15T12:00:00Z"
    chat_title: "null"

prompts:
  - >
    [
      {
        "role": "system",
        "content": {{ system_message | dump }}
      },
      {
        "role": "user",
        "content": {{ user_prompt | dump }}
      }
    ]

tests:
  - description: "Search - summary with citations"
    vars:
      user_prompt: |
        Use the following sources:

        1. Title: Example Domain
           URL: https://example.com
           Favicon: https://example.com/favicon.ico

        What is Example Domain used for?
    assert:
      - type: contains
        value: "##"
      - type: contains
        value: "<citation>"
      - type: contains
        value: "example.com"

  - description: "Search - coding response starts with code"
    vars:
      user_prompt: "Write a Python function that adds two numbers."
    assert:
      - type: contains
        value: "```"
      - type: contains
        value: "def"

  - description: "Search - translation"
    vars:
      user_prompt: "Translate to Spanish: Hello world."
    assert:
      - type: contains-any
        value:
          - "Hola"
          - "hola"

outputPath: ./promptfoo/promptfoo-results-search.json

sharing: false
